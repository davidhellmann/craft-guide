var e=Object.defineProperty,t=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,n=(t,i,a)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,l=(e,l)=>{for(var d in l||(l={}))i.call(l,d)&&n(e,d,l[d]);if(t)for(var d of t(l))a.call(l,d)&&n(e,d,l[d]);return e};import{d,r,e as o,x as s,l as u,u as c,z as p,o as h,c as g,b as m,a as v,p as y,R as b}from"./globals.30e98e7d.js";import{_ as f,a as S}from"./SvgSettings.855fd4fd.js";var w=d({emits:["loaded"],created(){this.$emit("loaded")}});w.render=function(e,t,i,a,n,l){return null};var E=d({name:"PlacementInlineEditor",components:{CraftFieldSelect:f},props:{placementId:String,placementInlineEditor:{type:String,required:!0}},setup:e=>{const t=r({guides:u,guideValue:null,placement:null,placementSaved:!1,userOperations:c});return t.placement={access:"all",group:"uiElement",groupId:e.placementInlineEditor,guideId:null,id:parseFloat(e.placementId)||null,portalMethod:"append",selector:null,theme:"default",uri:null},l({},o(t))},computed:{guideFieldOptions(){const e=[{label:"Select One",value:"__none__"}];return this.guides.forEach((t=>{e.push({label:t.title,value:t.slug})})),e}},methods:{async deletePlacement(){var e,t;(null==(e=this.placement)?void 0:e.id)&&await(null==(t=window.Craft)?void 0:t.postActionRequest("guide/placement/delete-placement",{data:JSON.stringify(this.placement)},((e,t,i)=>{var a,n,l,d;s("Deleting placement",e,t,i),this.placementSaved=!0,"success"===e.status?null==(n=null==(a=window.Craft)?void 0:a.cp)||n.displayNotice("Guide removed"):null==(d=null==(l=window.Craft)?void 0:l.cp)||d.displayError(e.data.error)})))},onGroupChanged(e){this.guideValue=e},onSaveClicked(){"__none__"===this.guideValue?this.deletePlacement():this.savePlacement()},async savePlacement(){var e;const t=this.guides.find((e=>e.slug===this.guideValue));t&&(this.placement.guideId=t.id),await(null==(e=window.Craft)?void 0:e.postActionRequest("guide/placement/save-placement",{data:JSON.stringify(this.placement)},((e,t,i)=>{var a,n,l,d;s("Saving placement",e,t,i),this.placementSaved=!0,"success"===e.status?null==(n=null==(a=window.Craft)?void 0:a.cp)||n.displayNotice("Guide UI element updated"):null==(d=null==(l=window.Craft)?void 0:l.cp)||d.displayError(e.data.error)})))}},mounted(){this.$refs.guideField.setFieldValue(this.guideFieldOptions[0].value),s("PlacementInlineEditor loaded")}});const C={key:0},I={key:0},O={key:0},G={key:1},T={key:1},N={key:0},_={key:1},k=v("p",null,"No guides have been created yet. Create a guide and then return here to select it for this UI element.",-1);E.render=function(e,t,i,a,n,l){const d=p("CraftFieldSelect");return e.placementInlineEditor?(h(),g("div",C,[e.placementSaved?(h(),g("div",I,["__none__"===e.guideValue?(h(),g("p",O,"Guide removed. Please reload this page and select another guide.")):(h(),g("p",G,"Guide added. Please reload this page to see the guide displayed here."))])):m("",!0),e.userOperations.useOrganizer?(h(),g("div",T,[e.guides.length?(h(),g("div",N,[v(d,{ref:"guideField",instructions:"Select a guide to be displayed here.",label:"Guide",name:"guide",options:e.guideFieldOptions,onValueChanged:e.onGroupChanged},null,8,["options","onValueChanged"]),v("button",{class:"btn submit",type:"button",onClick:t[1]||(t[1]=(...t)=>e.onSaveClicked&&e.onSaveClicked(...t))},"Save")])):(h(),g("div",_,[k]))])):m("",!0)])):m("",!0)};var D=d({name:"GuideDisplay",delimiters:["${","}"],components:{OnLoad:w,PlacementInlineEditor:E,SvgSettings:S},props:{enableInlineEditor:Boolean,guideDisplay:{type:String,required:!0},guideNavData:String,startInInlineEditor:{type:Boolean,required:!1},teleportContainerClass:String,teleportMethod:String,teleportSelector:String},setup:e=>{const t=r({currentGuide:"",data:{},guideNav:e.guideNavData?JSON.parse(e.guideNavData):[],hash:"",enableTldr:!1,proEdition:y,showInlineEditor:!1,showTldr:!1,userOperations:c});return t.proEdition&&t.guideNav.forEach((e=>{t.data[e.slug]={boolean1:!1,boolean2:!1,boolean3:!1,boolean4:!1,boolean5:!1,number1:0,number2:0,number3:0,number4:0,number5:0,string1:"",string2:"",string3:"",string4:"",string5:""}})),l({},o(t))},computed:{teleportTarget(){return this.teleportSelector?`#teleport-${this.guideDisplay}`:null}},methods:{onHashUpdated(){this.hash=window.location.hash.substr(1)},toggleTldr(e){s("Turning TLDR: "+(e?"on":"off")),this.showTldr=e;document.querySelectorAll(".tldr-show").forEach((t=>{e?t.removeAttribute("hidden"):t.setAttribute("hidden","hidden")}));document.querySelectorAll(".tldr-hide").forEach((t=>{e?t.setAttribute("hidden","hidden"):t.removeAttribute("hidden")})),localStorage.setItem("guide:display:tldr",e?"true":"false")},updateEnableTldr(){if(this.currentGuide){const e=document.querySelector(`.guide-${this.currentGuide} .tldr-hide, .guide-${this.currentGuide} .tldr-show, .guide-${this.currentGuide} [class^="tldr:"]`);s(`.guide-${this.currentGuide}`,e),this.enableTldr=null!==e}}},created(){var e;(null==(e=this.guideNav)?void 0:e.length)&&(this.currentGuide=this.guideNav[0].slug),this.showInlineEditor=this.startInInlineEditor},mounted(){this.updateEnableTldr(),this.toggleTldr("true"===localStorage.getItem("guide:display:tldr")),window.addEventListener("hashchange",this.onHashUpdated),s("GuideDisplay loaded")},beforeUnmount(){window.removeEventListener("hashchange",this.onHashUpdated)},watch:{currentGuide(){this.$nextTick((()=>{this.updateEnableTldr(),this.toggleTldr(this.showTldr)}))}}});const P=document.querySelectorAll("[data-guide-display]");P&&P.forEach((e=>{var t,i,a,n;if(null==(t=e.dataset)?void 0:t.guideDisplay){if(null==(i=e.dataset)?void 0:i.teleportSelector){const t=document.querySelector(e.dataset.teleportSelector);if(t){const i=document.createElement("div");i.id=`teleport-${e.dataset.guideDisplay}`,(null==(a=e.dataset)?void 0:a.teleportContainerClass)&&i.setAttribute("class",e.dataset.teleportContainerClass),"append"===(null==(n=e.dataset)?void 0:n.teleportMethod)?t.appendChild(i):t.insertBefore(i,t.firstChild)}}D.template=`#${e.dataset.guideDisplay}`,b(l({},D),e.dataset).mount(e)}}));
